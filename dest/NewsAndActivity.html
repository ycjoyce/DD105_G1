<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
  <title>浪愛回家後台</title>
  <!-- Icons-->
  <!-- <link href="node_modules/@coreui/icons/css/coreui-icons.min.css" rel="stylesheet">
  <link href="node_modules/flag-icon-css/css/flag-icon.min.css" rel="stylesheet">
  <link href="node_modules/font-awesome/css/font-awesome.min.css" rel="stylesheet">
  <link href="node_modules/simple-line-icons/css/simple-line-icons.css" rel="stylesheet"> -->
  <!-- Main styles for this application-->
  <link href="css/adminManage.css" rel="stylesheet">
</head>

<body class="app header-fixed sidebar-fixed aside-menu-fixed sidebar-lg-show">
  <div id="app">
    <!-- top_header -->
    <header class="app-header navbar">
    <button class="navbar-toggler sidebar-toggler d-lg-none mr-auto" type="button" data-toggle="sidebar-show">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="adminManage.html">
      <img class="navbar-brand-full" src="img/logo-wide.png" width="89" height="25" alt="CoreUI Logo">
      <!-- <img class="navbar-brand-minimized" src="img/brand/sygnet.svg" width="30" height="30" alt="CoreUI Logo"> -->
    </a>
    <button class="navbar-toggler sidebar-toggler d-md-down-none" type="button" data-toggle="sidebar-lg-show">
      <span class="navbar-toggler-icon"></span>
    </button>
    <!-- <ul class="nav navbar-nav d-md-down-none">
      <li class="nav-item px-3">
        <a class="nav-link" href="#">Dashboard</a>
      </li>
      <li class="nav-item px-3">
        <a class="nav-link" href="#">Users</a>
      </li>
      <li class="nav-item px-3">
        <a class="nav-link" href="#">Settings</a>
      </li>
    </ul> -->
    <ul class="nav navbar-nav ml-auto">
      <!-- <li class="nav-item d-md-down-none">
        <a class="nav-link" href="#">
          <i class="icon-bell"></i>
          <span class="badge badge-pill badge-danger">5</span>
        </a>
      </li> -->
      <!-- <li class="nav-item d-md-down-none">
        <a class="nav-link" href="#">
          <i class="icon-list"></i>
        </a>
      </li> -->
      <!-- <li class="nav-item d-md-down-none">
        <a class="nav-link" href="#">
          <i class="icon-location-pin"></i>
        </a>
      </li> -->
      <li class="nav-item mr-3 adminName"></li>

      <li class="nav-item mr-3 dropdown">
        <a class="nav-link" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
          <img class="img-avatar" src="img/7.jpg" alt="admin@bootstrapmaster.com">
        </a>
        <div class="dropdown-menu dropdown-menu-right">
          <!-- <div class="dropdown-header text-center">
            <strong>Account</strong>
          </div>
          <a class="dropdown-item" href="#">
            <i class="fa fa-bell-o"></i> Updates
            <span class="badge badge-info">42</span>
          </a>
          <a class="dropdown-item" href="#">
            <i class="fa fa-envelope-o"></i> Messages
            <span class="badge badge-success">42</span>
          </a>
          <a class="dropdown-item" href="#">
            <i class="fa fa-tasks"></i> Tasks
            <span class="badge badge-danger">42</span>
          </a>
          <a class="dropdown-item" href="#">
            <i class="fa fa-comments"></i> Comments
            <span class="badge badge-warning">42</span>
          </a>
          <div class="dropdown-header text-center">
            <strong>Settings</strong>
          </div>
          <a class="dropdown-item" href="#">
            <i class="fa fa-user"></i> Profile</a>
          <a class="dropdown-item" href="#">
            <i class="fa fa-wrench"></i> Settings</a>
          <a class="dropdown-item" href="#">
            <i class="fa fa-usd"></i> Payments
            <span class="badge badge-secondary">42</span>
          </a>
          <a class="dropdown-item" href="#">
            <i class="fa fa-file"></i> Projects
            <span class="badge badge-primary">42</span>
          </a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="#">
            <i class="fa fa-shield"></i> Lock Account</a> -->
          <a class="dropdown-item" href="backend-login.html" style="text-align: center;">登出</a>
        </div>
      </li>
      
    </ul>
    <!-- <button class="navbar-toggler aside-menu-toggler d-md-down-none" type="button" data-toggle="aside-menu-lg-show">
      <span class="navbar-toggler-icon"></span>
    </button> -->
    <!-- <button class="navbar-toggler aside-menu-toggler d-lg-none" type="button" data-toggle="aside-menu-show">
      <span class="navbar-toggler-icon"></span>
    </button> -->
  </header>
    <div class="app-body">
      <div class="sidebar">
        <!-- sidebar menu-->
        <nav class="sidebar-nav">
  <ul class="nav">
    <!-- <li class="nav-item">
        <a class="nav-link" href="index.html">
          <i class="nav-icon icon-speedometer"></i> Dashboard
          <span class="badge badge-primary">NEWs</span>
        </a>
      </li> -->
    <!-- <li class="nav-title">Theme</li>
      <li class="nav-item">
        <a class="nav-link" href="colors.html">
          <i class="nav-icon icon-drop"></i> Colors</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="typography.html">
          <i class="nav-icon icon-pencil"></i> Typography</a>
      </li> -->
    <!-- <li class="nav-title">Components</li> -->

    
    <li class="nav-item">
      <a class="nav-link" href="adminManage.html">管理員管理</a>
    </li>
    
    <li class="nav-item nav-dropdown">
      <a class="nav-link nav-dropdown-toggle" href="#">
        <i class="nav-icon icon-drop"></i>GPS地圖管理</a>
      <ul class="nav-dropdown-items">
        <li class="nav-item">
          <a class="nav-link" href="petFriendly.html">↪ 寵物友善空間管理</a>
        </li>
        <!-- <li class="nav-item">
          <a class="nav-link" href="petFriendlyScore.html">寵物友善空間評論管理</a>
        </li> -->
        <!-- <li class="nav-item">
          <a class="nav-link" href="base/carousel.html">寵物友善空間收藏管理</a>
        </li> -->
        <!-- <li class="nav-item">
          <a class="nav-link" href="lostPetReport.html">寵物遺失回報管理</a>
        </li> -->
        
        <!-- <li class="nav-item">
            <a class="nav-link" href="base/forms.html">
              <i class="nav-icon icon-puzzle"></i> Forms</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="base/jumbotron.html">
              <i class="nav-icon icon-puzzle"></i> Jumbotron</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="base/list-group.html">
              <i class="nav-icon icon-puzzle"></i> List group</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="base/navs.html">
              <i class="nav-icon icon-puzzle"></i> Navs</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="base/pagination.html">
              <i class="nav-icon icon-puzzle"></i> Pagination</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="base/popovers.html">
              <i class="nav-icon icon-puzzle"></i> Popovers</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="base/progress.html">
              <i class="nav-icon icon-puzzle"></i> Progress</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="base/scrollspy.html">
              <i class="nav-icon icon-puzzle"></i> Scrollspy</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="base/switches.html">
              <i class="nav-icon icon-puzzle"></i> Switches</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="base/tables.html">
              <i class="nav-icon icon-puzzle"></i> Tables</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="base/tabs.html">
              <i class="nav-icon icon-puzzle"></i> Tabs</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="base/tooltips.html">
              <i class="nav-icon icon-puzzle"></i> Tooltips</a>
          </li> -->
      </ul>
    </li>
    <li class="nav-item nav-dropdown">
      <a class="nav-link nav-dropdown-toggle" href="#">
        <i class="nav-icon icon-cursor"></i>募款管理</a>
      <ul class="nav-dropdown-items">
        <li class="nav-item">
          <a class="nav-link" href="fundRaising.html">
            <i class="nav-icon icon-cursor"></i>↪ 募款專案管理</a>
        </li>
        <!-- <li class="nav-item">
          <a class="nav-link" href="buttons/button-group.html">
            <i class="nav-icon icon-cursor"></i> 募款收藏管理</a>
        </li> -->
        <!-- <li class="nav-item">
          <a class="nav-link" href="buttons/dropdowns.html">
            <i class="nav-icon icon-cursor"></i> 參與捐款管理</a>
        </li> -->
        <!-- <li class="nav-item">
            <a class="nav-link" href="buttons/brand-buttons.html">
              <i class="nav-icon icon-cursor"></i> Brand Buttons</a>
          </li> -->
      </ul>
    </li>
    <!-- <li class="nav-item">
        <a class="nav-link" href="charts.html">Charts</a>
      </li> -->
    <li class="nav-item nav-dropdown">
      <a class="nav-link nav-dropdown-toggle" href="#">客製化管理</a>
      <ul class="nav-dropdown-items">
        <!-- <li class="nav-item">
          <a class="nav-link" href="icons/coreui-icons.html">客製化項圈管理</a>
        </li> -->
        <!-- <li class="nav-item">
          <a class="nav-link" href="customizedColor.html">客製化顏色管理</a>
        </li> -->
        <!-- <li class="nav-item">
          <a class="nav-link" href="icons/font-awesome.html">客製化字型管理</a>
        </li> -->
        <li class="nav-item">
          <a class="nav-link" href="customizedTag.html">↪ 客製化吊牌管理</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="orderRecord.html">↪ 客製化訂單紀錄管理</a>
        </li>

      </ul>
    </li>
    <!-- <li class="nav-item nav-dropdown">
      <a class="nav-link nav-dropdown-toggle" href="#">貼文區管理</a>
      <ul class="nav-dropdown-items">
        <li class="nav-item">
          <a class="nav-link" href="postInfo.html">貼文資訊管理</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="postKey.html">貼文關鍵字管理</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="postComment.html">貼文留言管理</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="prNo.html">貼文檢舉管理</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="postCommentReport.html">貼文留言檢舉管理</a>
        </li>
      </ul>
    </li>
    <li class="nav-item nav-dropdown">
      <a class="nav-link nav-dropdown-toggle" href="#">照片牆管理</a>
      <ul class="nav-dropdown-items">
        <li class="nav-item">
          <a class="nav-link" href="gcNo.html">照片牆留言管理</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="galleryPhotoReport.html">照片牆照片檢舉管理</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="galleryCommentReport.html">照片牆留言檢舉管理</a>
        </li>
      </ul> 
    </li> -->
    <li class="nav-item">
      <a class="nav-link" href="NewsAndActivity.html">活動/新聞/宣導管理</a>
    </li>
    <!-- <li class="nav-item">
      <a class="nav-link" href="widgets.html">常見問答管理</a>
    </li> -->
    <li class="nav-item nav-dropdown">
      <a class="nav-link nav-dropdown-toggle" href="#"><i class="nav-icon icon-pie-chart"></i>會員管理</a>
      <ul class="nav-dropdown-items">
        <li class="nav-item">
          <a class="nav-link" href="memInfo.html" target="_top">↪ 會員資料管理</a>
        </li>
        <!-- <li class="nav-item">
          <a class="nav-link" href="blacklist.html" target="_top">黑名單管理</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="messageManage.html" target="_top">私信資料管理</a>
        </li> -->
      </ul>
    </li>
  </ul>
</nav>
        <!-- <button class="sidebar-minimizer brand-minimizer" type="button"></button> -->
      </div>
      <main class="main">
        <!-- Breadcrumb-->
        <ol class="breadcrumb">
          <li class="breadcrumb-item">首頁</li>
          <li class="breadcrumb-item">
            <a href="NewsAndActivity.html">活動/新聞/宣導管理</a>
          </li>
          <!-- <li class="breadcrumb-item active">Dashboard</li> -->
          <!-- Breadcrumb Menu-->
          <li class="breadcrumb-menu d-md-down-none">
            <!-- <div class="btn-group" role="group" aria-label="Button group">
            <a class="btn" href="#">
              <i class="icon-speech"></i>
            </a>
            <a class="btn" href="./">
              <i class="icon-graph"></i>  Dashboard</a>
            <a class="btn" href="#">
              <i class="icon-settings"></i>  Settings</a>
          </div> -->
          </li>
        </ol>
        <div class="container-fluid">
          <!-- 中間內容 -->

          <div class="row">
    <div class="col-md-12">
        <div class="accordion" id="accordionExample">
            <div class="card">
                <div class="card-header" id="headingOne">
                    <h2 class="mb-0">
                        <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseOne"
                            aria-expanded="true" aria-controls="collapseOne">
                            活動/新聞/宣導上架
                        </button>
                    </h2>
                </div>
                <div id="collapseOne" class="collapse show" aria-labelledby="headingOne"
                    data-parent="#accordionExample">
                    <div class="card-body">
                        <div class="row">
                            <iframe id="id_iframe" name="id_iframe" style="display:none;"></iframe>
                            <form action="./php/add-activity.php" method="post" enctype="multipart/form-data" class="col-xl-12 upact"
                                target="id_iframe" id="actForm">
                                <input type="text" name="post" value="updata_activity" style="display: none;"
                                    v-if="update == true">
                                <input type="text" name="post" value="add_activity" style="display: none;"
                                    v-if="update == false">

                                <div class="col-xl-6 updata_act_mom" style="vertical-align: middle">
                                    <label class="col-xl-12 updata_act" for="upimg"
                                        :style="{backgroundImage:'url('+upInfors.activity_img+')'}">
                                        <input type="file" name="act_img" id="upimg" style="display: none;"
                                         @change="up_img">
                                        <img src="./img/upload-zone.png" class="uploadimg"
                                            v-if="upInfors.activity_img == ''">
                                        <!-- <img :src=upInfors.activity_img class="act_img" v-else> -->
                                        <div class="img_name" >{{ upInfors.activity_g }}</div>
                                    </label>
                                </div> 
                                <div class="col-xl-6">
                                    <div class="form-group" style="display: inline-block; width: 49%;">
                                        <label for="activity_num"> 活動/新聞/宣導編號</label>
                                        <input type="number" class="form-control" id="activity_num" name="activity_num"
                                            min="0" step="1" v-model="upInfors.activity_num" v-if="update == false">
                                        <input type="number" class="form-control" id="activity_num" name="activity_num"
                                            min="0" step="1" v-model="upInfors.activity_num" v-if="update == true"
                                            readonly>
                                    </div>
                                    <div class="form-group" style="display: inline-block; width: 49%;">
                                        <label for="activity_name"> 活動/新聞/宣導名稱</label>
                                        <input type="text" class="form-control" id="activity_name" name="activity_name"
                                            v-model="upInfors.activity_name">
                                    </div>
                                    <div class="form-group" style="display: inline-block; width: 49%;">
                                        <label for="activity_type"> 活動/新聞/宣導類型</label>
                                        <select name="activity_type" id="activity_type"
                                            v-model="upInfors.activity_type">
                                            <option value="活動">活動</option>
                                            <option value="新聞">新聞</option>
                                            <option value="宣導">宣導</option>
                                        </select>
                                    </div>
                                    <!-- <div class="form-group" style="display: inline-block; width: 49%;">
                                        <label for="activity_fin"> 活動/新聞/宣導結束時間</label>
                                        <input type="date" class="form-control" id="activity_fin" name="activity_fin">
                                    </div> -->
                                    <div class="form-group" style="display: inline-block; width: 100%">
                                        <label for="activity_Introduction"> 活動/新聞/宣導內容介紹</label>
                                        <textarea type="date" class="form-control" id="activity_Introduction" rows="8"
                                            name="activity_Introduction" v-model="upInfors.activity_Introduction"
                                            style="resize: none"></textarea>
                                    </div>

                                    <button type="submit" class="btn btn-primary submitbtn" style="display:block"
                                        @click="send_act" v-if="!update">上傳</button>
                                    <button type="submit" class="btn btn-primary submitbtn" style="display:block"
                                        @click="update_act" v-else>更新</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="card-header" id="headingTwo">
                    <h2 class="mb-0">
                        <button class="btn btn-link collapsed" type="button" data-toggle="collapse"
                            data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                            活動/新聞/宣導下架
                        </button>
                    </h2>
                </div>
                <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample">
                    <div class="card-body">
                        <table class="table table-borderless">
                            <thead>
                                <tr>
                                    <th scope="col" style="text-align: center;"> 活動/新聞/宣導編號</th>
                                    <th scope="col" style="text-align: center;"> 活動/新聞/宣導名稱</th>
                                    <th scope="col" style="text-align: center;"> 活動/新聞/宣導類型</th>
                                    <th scope="col" style="text-align: center;"> 活動/新聞/宣導內容介紹</th>
                                    <th scope="col" style="text-align: center;">設定</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="item in activity">
                                    <th scope="row" style="text-align: center;">{{ item.inforNo}}</th>
                                    <td style="text-align: center;">{{ item.inforName }}</td>
                                    <td style="text-align: center;">{{ item.inforType }}</td>
                                    <td style="text-align: center;">{{ item.inforContent }}</td>
                                    <td style="text-align: center;">
                                        <a href="#" @click.prevent="get_edit(item.inforNo);update = true">
                                            編輯</a> / <a href="#" @click.prevent="get_delete(item.inforNo)">下架</a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>

          <!-- end -->
        </div>
      </main>
    </div>
  </div>
  
  <!-- CoreUI and necessary plugins-->
  <script src="./js/jquery.min.js"></script>
  <script src="./js/popper.min.js"></script>
  <script src="./js/bootstrap.min.js"></script>
  <script src="./js/pace.min.js"></script>
  <script src="./js/perfect-scrollbar.min.js"></script>
  <script src="./js/coreui.min.js"></script>
  <script src="./js/backend-managerName.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.11/vue.js"></script>
  <script src="./js/axios.min.js"></script>
  <script>
    var back = new Vue({
      el: "#app",
      data: {
        activity: [], // 活動上下架
        update: false,
        upInfors: {
          activity_img: '',
          activity_num: '',
          activity_name: '',
          activity_type: '',
          activity_Introduction: '',
          activity_g: '',
        }
      },
      methods: {

        clean_form() { //清除表單資料 

          document.getElementById('actForm').reset();
        },

        get_activity() { //取得目前有建立的活動資訊
          var vm = this;
          axios.post('./php/NewsAndActivity.php').then(function (res) {
            console.log(res.data);
            vm.activity = res.data;
            // console.log(vm.activity);
          }).catch(err => { console.log(err) })
        },
        up_img() {
          var vm = this;
          var upimg = document.getElementById('upimg').files[0];//抓上傳的圖片
          console.log(upimg);
          vm.upInfors.activity_g = upimg.name; //圖片檔名
          var readFile = new FileReader();
          readFile.readAsDataURL(upimg); //將抓取的圖片編碼成data URL
          readFile.addEventListener('load', function () {
            vm.upInfors.activity_img = readFile.result;
          })
        },
        send_act() {
          var vm = this;
          if (vm.upInfors.activity_img == '') {
            alert('請上傳圖片');
          } else if (vm.upInfors.activity_num == '') {
            alert('編號不能為空');
          } else if (vm.upInfors.activity_name == '') {
            alert('名稱不能為空');
          } else if (vm.upInfors.activity_type == '') {
            alert('請選擇一種類型');
          } else if (vm.upInfors.activity_Introduction == '') {
            alert('內容不能為空');
          } else {
            setTimeout(function () {
              alert('上傳成功!')
              vm.clean_form();
              vm.get_activity();

              var collapseOne = document.getElementById('collapseOne');
              var collapseTwo = document.getElementById('collapseTwo');
              collapseOne.className = "collapse";
              collapseTwo.className = "collapse show";

            }, 1000)
          }

        },

        update_act() {

          var vm = this;
          setTimeout(function () {
            alert('更新成功!')
            vm.clean_form();
            vm.get_activity();

            var collapseOne = document.getElementById('collapseOne');
            var collapseTwo = document.getElementById('collapseTwo');
            collapseOne.className = "collapse";
            collapseTwo.className = "collapse show";

          }, 1000)
        },

        get_edit(no) {
          var vm = this;
          axios.get('./php/update_activity.php?id=' + no).then(function (res) {
            console.log(res.data);
            vm.upInfors.activity_img = `./img/${res.data.inforPic}`;
            vm.upInfors.activity_num = res.data.inforNo;
            vm.upInfors.activity_name = res.data.inforName;
            vm.upInfors.activity_type = res.data.inforType;
            vm.upInfors.activity_Introduction = res.data.inforContent;
            vm.upInfors.activity_g = res.data.inforPic;

            var collapseOne = document.getElementById('collapseOne');
            var collapseTwo = document.getElementById('collapseTwo');
            collapseOne.className = "collapse show";
            collapseTwo.className = "collapse";
          }).catch(err => {
            console.log(err)
          })
        },

        get_delete(no) {
          var ans = confirm('確定要刪除嗎?');
          var vm = this;
          vm.clean_form();
          if (ans) {
            axios.get('./php/delete_activity.php?id=' + no).then(res => {
              alert("刪除成功!");
              vm.get_activity();
            })
          }
        }

      },
      mounted() {
        this.get_activity();
      },



    })
  </script>
</body>

</html>